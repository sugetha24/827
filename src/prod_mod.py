'''
Created on Sep 25, 2012

@author: sugethk
'''
productions={
         '2   3   54'   :1,
         '55   56'   :2,
         '4   10   19'    :3,
         '4   19'   :3,
         '57   5   54'   :4,
         '6'   :5,
         '6   7   58'   :6,
         '7   58'   :6,
         '8'   :7,
         '8   59   56'   :8,
         '8   59   56   60   61'   :8,
         '59   56   62   61   63'   :8,
         '8   59   56   62   61   64   61   65'   :8,
         '9   56'   :8,
         '9   56   60   61'   :8,
         '9   56   62   61   63'   :8,
         '9   56   62   61   64   61   65'   :8,
         '66'   :9,
         '67'   :9,
         '11'   :10,
         '11   12'   :11,
         '12'   :11,
         '13   4   21   54'   :12,
         '13   21   54'   :12,
         '14   15'   :13,
         '14   16'   :13,
         '68   56'   :14,
         '69   70'   :15,
         '17   70'   :16,
         '17   59   18   9   56'   :17,
         '17   59   18   9   56   62   61   63'   :17,
         '17   59   18   9   56   62   61   64   61   65'   :17,
         '69   18   9   56'   :17,
         '69   18   9   56   62   61   63'   :17,
         '69   18   9   56   62   61   64   61   65'   :17,
         '71'   :18,
         '72'   :18,
         '20   21   54'   :19,
         '73'   :20,
         '22'   :21,
         '22   23'   :22,
         '23'   :22,
         '37   58'   :23,
         '34   58'   :23,
         '39   58'   :23,
         '24   58'   :23,
         '27   58'   :23,
         '30   58'   :23,
         '25'   :24,
         '25   59   56'   :25,
         '25   59   56   74   48   75'   :25,
         '25   59   56   74   48   76   48   75'   :25,
         '26   59   56'   :25,
         '26   59   56   74   48   75'   :25,
         '26   59   56   74   48   76   48   75'   :25,
         '77   78'   :26,
         '28'   :27,
         '29'   :27,
         '28   59   56'   :28,
         '28   59   53'   :28,
         '28   59   56   74   48   75'   :28,
         '28   59   56   74   48   76   48   75'   :28,
         '29   59   56'   :28,
         '29   59   53'   :28,
         '29   59   56   74   48   75'   :28,
         '29   59   56   74   48   76   48   75'   :28,
         '79   78'   :29,
         '1   15'   :30,
         '31   32'   :30,
         '80   56'   :31,
         '33   70'   :32,
         '33   59   18   56'   :33,
         '33   59   53'   :33,
         '33   59   18   56   74   48   75'   :33,
         '33   59   18   56   74   48   76   48   75'   :33,
         '69   18   56'   :33,
         '69   53'   :33,
         '69   18   56   74   48   75'   :33,
         '69   18   56   74   48   76   48   75'   :33,
         '36   21   54'   :34,
         '35   21   54'   :34,
         '36   21   81'   :35,
         '82   83   42   84   85'   :36,
         '38   21   86   48   54'   :37,
         '87'   :38,
         '40'   :39,
         '41'   :40,
         '56   88   48'   :41,
         '56   74   48   75   88   48'   :41,
         '56   74   48   76   48   75   88   48'   :41,
         '43'   :42,
         '43   89   44'   :43,
         '44'   :43,
         '45'   :44,
         '45   90   46'   :45,
         '46'   :45,
         '91   47'   :46,
         '47'   :46,
         '48   92   48'   :47,
         '48   93   48'   :47,
         '48   94   48'   :47,
         '48   95   48'   :47,
         '48   96   48'   :47,
         '48   97   48'   :47,
         '48'   :47,
         '49'   :48,
         '49   98   50'   :49,
         '49   99   50'   :49,
         '99   50'   :49,
         '50'   :49,
         '51'   :50,
         '51   100   52'   :51,
         '51   101   52'   :51,
         '52'   :51,
         '83   42   84'   :52,
         '53'   :52,
         '56'   :52,
         '56   74   48   75'   :52,
         '56   74   48   76   48   75'   :52,
         '61'   :53,
         '102'   :53}

reductions={
         '2   3   54'   :1,
         '55   56'   :2,
         '4   10   19'    :3,
         '4   19'   :4,
         '57   5   54'   :5,
         '6'   :6,
         '6   7   58'   :7,
         '7   58'   :8,
         '8'   :9,
         '8   59   56'   :10,
         '8   59   56   60   61'   :11,
         '59   56   62   61   63'   :12,
         '8   59   56   62   61   64   61   65'   :13,
         '9   56'   :14,
         '9   56   60   61'   :15,
         '9   56   62   61   63'   :16,
         '9   56   62   61   64   61   65'   :17,
         '66'   :18,
         '67'   :19,
         '11'   :20,
         '11   12'   :21,
         '12'   :22,
         '13   4   21   54'   :23,
         '13   21   54'   :24,
         '14   15'   :25,
         '14   16'   :26,
         '68   56'   :27,
         '69   70'   :28,
         '17   70'   :29,
         '17   59   18   9   56'   :30,
         '17   59   18   9   56   62   61   63'   :31,
         '17   59   18   9   56   62   61   64   61   65'   :32,
         '69   18   9   56'   :33,
         '69   18   9   56   62   61   63'   :34,
         '69   18   9   56   62   61   64   61   65'   :35,
         '71'   :36,
         '72'   :37,
         '20   21   54'   :38,
         '73'   :39,
         '22'   :40,
         '22   23'   :41,
         '23'   :42,
         '37   58'   :43,
         '34   58'   :44,
         '39   58'   :45,
         '24   58'   :46,
         '27   58'   :47,
         '30   58'   :48,
         '25'   :49,
         '25   59   56'   :50,
         '25   59   56   74   48   75'   :51,
         '25   59   56   74   48   76   48   75'   :52,
         '26   59   56'   :53,
         '26   59   56   74   48   75'   :54,
         '26   59   56   74   48   76   48   75'   :55,
         '77   78'   :56,
         '28'   :57,
         '29'   :58,
         '28   59   56'   :59,
         '28   59   53'   :60,
         '28   59   56   74   48   75'   :61,
         '28   59   56   74   48   76   48   75'   :62,
         '29   59   56'   :63,
         '29   59   53'   :64,
         '29   59   56   74   48   75'   :65,
         '29   59   56   74   48   76   48   75'   :66,
         '79   78'   :67,
         '1   15'   :68,
         '31   32'   :69,
         '80   56'   :70,
         '33   70'   :71,
         '33   59   18   56'   :72,
         '33   59   53'   :73,
         '33   59   18   56   74   48   75'   :74,
         '33   59   18   56   74   48   76   48   75'   :75,
         '69   18   56'   :76,
         '69   53'   :77,
         '69   18   56   74   48   75'   :78,
         '69   18   56   74   48   76   48   75'   :79,
         '36   21   54'   :80,
         '35   21   54'   :81,
         '36   21   81'   :82,
         '82   83   42   84   85'   :83,
         '38   21   86   48   54'   :84,
         '87'   :85,
         '40'   :86,
         '41'   :87,
         '56   88   48'   :88,
         '56   74   48   75   88   48'   :89,
         '56   74   48   76   48   75   88   48'   :90,
         '43'   :91,
         '43   89   44'   :92,
         '44'   :93,
         '45'   :94,
         '45   90   46'   :95,
         '46'   :96,
         '91   47'   :97,
         '47'   :98,
         '48   92   48'   :99,
         '48   93   48'   :100,
         '48   94   48'   :101,
         '48   95   48'   :102,
         '48   96   48'   :103,
         '48   97   48'   :104,
         '48'   :105,
         '49'   :106,
         '49   98   50'   :107,
         '49   99   50'   :108,
         '99   50'   :109,
         '50'   :110,
         '51'   :111,
         '51   100   52'   :112,
         '51   101   52'   :113,
         '52'   :114,
         '83   42   84'   :115,
         '53'   :116,
         '56'   :117,
         '56   74   48   75'   :118,
         '56   74   48   76   48   75'   :119,
         '61'   :120,
         '102'   :121}